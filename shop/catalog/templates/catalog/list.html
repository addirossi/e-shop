{% extends 'base.html' %}
{% load static %}
{% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}
{% block title %}{% if category %}{{ category.name }}{% else %}Products list{% endif %}{% endblock title %}
{% block content %}
    <div class="columns-container">
        <div class="container" id="columns">
            <!-- breadcrumb -->
            <div class="breadcrumb clearfix">
                <a class="home" href="#" title="Return to Home">Home</a>
                <span class="navigation-pipe">&nbsp;</span>
                <span class="navigation_page">Fashion</span>
            </div>
            <!-- ./breadcrumb -->
            <!-- row -->
            <div class="row">
                <!-- Left colunm -->
                <div class="column col-xs-12 col-sm-3" id="left_column">

                    <!-- block filter -->
                    <div class="block left-module">
                        <p class="title_block">Filter selection</p>
                        <div class="block_content">
                            <!-- layered -->
                            <div class="layered layered-filter-price">
                                <form>
                                    <div class="layered_subtitle">Brands</div>
                                    <div class="layered-content">
                                        <ul class="check-box-list">

                                                {% for brand in brands %}
                                                    <li >
                                                        <input style="display: none" type="checkbox" id="brand-{{ brand.id }}" name="filter-brand" value="{{ brand.id }}" {% if brand.id in filtered_brands %}checked{% endif %} />
                                                        <label for="brand-{{ brand.id }}">
                                                           <span class="button"></span>
                                                           {{ brand.brand }}
                                                        </label>
                                                    </li>
                                                {% endfor %}

                                        </ul>
                                    </div>
                                    <!-- filter price -->
                                    <div class="layered_subtitle">price</div>
                                    <div class="layered-content slider-range">

                                        <div data-label-reasult="Range:" data-min="0" data-max="500" data-unit="$" class="slider-range-price" data-value-min="50" data-value-max="350"></div>
                                        <div class="amount-range-price">Range: $50 - $350</div>
                                        <ul class="check-box-list">
                                            <li>
                                                <input type="checkbox" id="p1" name="cc" />
                                                <label for="p1">
                                                <span class="button"></span>
                                                $20 - $50<span class="count">(0)</span>
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="p2" name="cc" />
                                                <label for="p2">
                                                <span class="button"></span>
                                                $50 - $100<span class="count">(0)</span>
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="p3" name="cc" />
                                                <label for="p3">
                                                <span class="button"></span>
                                                $100 - $250<span class="count">(0)</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                    <!-- ./filter price -->
                                    <!-- filter color -->
                                    <div class="layered_subtitle">Color</div>
                                    <div class="layered-content filter-color">
                                        <ul class="check-box-list">
                                            <li>
                                                <input type="checkbox" id="color1" name="cc" />
                                                <label style=" background:#aab2bd;" for="color1"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color2" name="cc" />
                                                <label style=" background:#cfc4a6;" for="color2"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color3" name="cc" />
                                                <label style=" background:#aab2bd;" for="color3"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color4" name="cc" />
                                                <label style=" background:#fccacd;" for="color4"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color5" name="cc" />
                                                <label style="background:#964b00;" for="color5"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color6" name="cc" />
                                                <label style=" background:#faebd7;" for="color6"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color7" name="cc" />
                                                <label style=" background:#e84c3d;" for="color7"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color8" name="cc" />
                                                <label style=" background:#c19a6b;" for="color8"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color9" name="cc" />
                                                <label style=" background:#f39c11;" for="color9"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color10" name="cc" />
                                                <label style=" background:#5d9cec;" for="color10"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color11" name="cc" />
                                                <label style=" background:#a0d468;" for="color11"><span class="button"></span></label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="color12" name="cc" />
                                                <label style=" background:#f1c40f;" for="color12"><span class="button"></span></label>
                                            </li>

                                        </ul>
                                    </div>
                                    <!-- ./filter color -->

                                    <!-- ./filter size -->
                                    <div class="layered_subtitle">Size</div>
                                    <div class="layered-content filter-size">
                                        <ul class="check-box-list">
                                            <li>
                                                <input type="checkbox" id="size1" name="cc" />
                                                <label for="size1">
                                                <span class="button"></span>X
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size2" name="cc" />
                                                <label for="size2">
                                                <span class="button"></span>XXL
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size3" name="cc" />
                                                <label for="size3">
                                                <span class="button"></span>XL
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size4" name="cc" />
                                                <label for="size4">
                                                <span class="button"></span>XXL
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size5" name="cc" />
                                                <label for="size5">
                                                <span class="button"></span>M
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size6" name="cc" />
                                                <label for="size6">
                                                <span class="button"></span>XXS
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size7" name="cc" />
                                                <label for="size7">
                                                <span class="button"></span>S
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size8" name="cc" />
                                                <label for="size8">
                                                <span class="button"></span>XS
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size9" name="cc" />
                                                <label for="size9">
                                                <span class="button"></span>34
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size10" name="cc" />
                                                <label for="size10">
                                                <span class="button"></span>36
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size11" name="cc" />
                                                <label for="size11">
                                                <span class="button"></span>35
                                                </label>
                                            </li>
                                            <li>
                                                <input type="checkbox" id="size12" name="cc" />
                                                <label for="size12">
                                                <span class="button"></span>37
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                    <!-- ./filter size -->
                                    <div>
                                        <button type="submit" class="btn filter-btn">Find</button>
                                    </div>
                                </form>
                            </div>
                            <!-- ./layered -->

                        </div>
                    </div>
                    <!-- ./block filter  -->
                </div>
                <!-- ./left colunm -->
                <!-- Center colunm-->
                <div class="center_column col-xs-12 col-sm-9" id="center_column">
                    <!-- category-slider -->
                    <div class="category-slider">
                        <ul class="owl-carousel owl-style2" data-dots="false" data-loop="true" data-nav = "true" data-autoplayTimeout="1000" data-autoplayHoverPause = "true" data-items="1">
                            <li>
                                <img src="{% static 'data/cat-slider1.jpg' %}" alt="category-slider" />
                            </li>
                            <li>
                                <img src="{% static 'data/cat-slider2.jpg' %}" alt="category-slider" />
                            </li>
                            <li>
                                <img src="{% static 'data/cat-slider3.jpg' %}" alt="category-slider" />
                            </li>
                        </ul>
                    </div>
                    <!-- ./category-slider -->
                    <!-- subcategories -->
                    <div class="subcategories">
                        <ul>
                            <li class="current-categorie">
                                <a href="#">Women's Fashion</a>
                            </li>
                            <li>
                                <a href="#">Tops</a>
                            </li>
                            <li>
                                <a href="#">Dresses</a>
                            </li>
                            <li>
                                <a href="#">Bags & Shoes</a>
                            </li>
                            <li>
                                <a href="#">Pants</a>
                            </li>
                            <li>
                                <a href="#">Blouses</a>
                            </li>
                        </ul>
                    </div>
                    <!-- ./subcategories -->
                    <!-- view-product-list-->
                    <div id="view-product-list" class="view-product-list">
                        <h2 class="page-heading">
                            <span class="page-heading-title">{% if category %}{{ category.name }}{% else %}Products{% endif %}</span>
                        </h2>
                        <ul class="display-product-option">
                            <li class="view-as-grid selected">
                                <span>grid</span>
                            </li>
                            <li class="view-as-list">
                                <span>list</span>
                            </li>
                        </ul>
                        <!-- PRODUCT LIST -->
                        <ul class="row product-list grid">
                            {% for product in products %}
                                <li class="col-sx-12 col-sm-4">
                                    <div class="product-container">

                                        <div class="left-block">
                                            <a href="{{ product.get_absolute_url }}">
                                                <img class="img-responsive" alt="product" src="{% if product.image %}{{ MEDIA_URL }}{{ product.image}}{% else %}{% static 'data/p40.jpg' %}{% endif %}" />
                                            </a>
                                            <div class="add-to-cart">
                                                <form action="{% url "cart:cart-add-json" product.id %}" method="post" class="cart-add-form" data-redirect="{% url 'cart:cart-detail' %}">
                                                  {{ cart_product_form }}
                                                  {% csrf_token %}
                                                  <input type="submit" value="Add to cart">
                                                </form>
                                            </div>
                                        </div>
                                        <div class="right-block">
                                            <h5 class="product-name"><a href="{{ product.get_absolute_url }}">{{ product.name }}</a></h5>
                                            <div class="product-star">
                                                <i class="fa fa-star"></i>
                                                <i class="fa fa-star"></i>
                                                <i class="fa fa-star"></i>
                                                <i class="fa fa-star"></i>
                                                <i class="fa fa-star-half-o"></i>
                                            </div>
                                            <div class="content_price">
                                                <span class="price product-price">${{ product.price }}</span>
                                                <span class="price old-price">$52,00</span>
                                            </div>
                                            <div class="info-orther">
                                                <p>Item Code: #453217907</p>
                                                <p class="availability">Availability: <span>In stock</span></p>
                                                <div class="product-desc">
                                                    Vestibulum eu odio. Suspendisse potenti. Morbi mollis tellus ac sapien. Praesent egestas tristique nibh. Nullam dictum felis eu pede mollis pretium. Fusce egestas elit eget lorem. In auctor lobortis lacus. Suspendisse faucibus, nunc et pellentesque egestas, lacus ante convallis tellus, vitae iaculis lacus elit id tortor.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}


                        </ul>
                    </div>
                    <div class="sortPagiBar pull-left">
{#                    #}
{#                    #}
{#    <span class="step-links">#}
{#        {% if contacts.has_previous %}#}
{#            <a href="?page={{ contacts.previous_page_number }}">previous</a>#}
{#        {% endif %}#}
{##}
{#        <span class="current">#}
{#            Page {{ contacts.number }} of {{ contacts.paginator.num_pages }}.#}
{#        </span>#}
{#    </span>#}

                        <div class="bottom-pagination pull-left">
                            <nav>
                              <ul class="pagination">
                                {% if products.has_previous %}
                                    <li>
                                        <a href="?page={{ products.previous_page_number }}" aria-label="Previous">
                                            <span aria-hidden="true">&laquo; Previous</span>
                                        </a>
                                    </li>
                                {% endif %}
                                {% for page in products.paginator.page_range %}
                                    <li {% if page == products.number %}class="active" {% endif %}><a href="?page={{ page }}">{{ page }}</a></li>
                                {% endfor %}
                                {% if products.has_next %}
                                    <li>
                                        <a href="?page={{ products.next_page_number }}" aria-label="Next">
                                            <span aria-hidden="true">Next &raquo;</span>
                                        </a>
                                    </li>
                                {% endif %}
                              </ul>
                            </nav>
                        </div>
{#                        <div class="show-product-item">#}
{#                            <select name="">#}
{#                                <option value="">Show 18</option>#}
{#                                <option value="">Show 20</option>#}
{#                                <option value="">Show 50</option>#}
{#                                <option value="">Show 100</option>#}
{#                            </select>#}
{#                        </div>#}
                        <div class="sort-product">
                            <form id="product-sort-form">
                            <select name="sort" id="id_sort-products">
                                <option value="name" {% if sort_field == 'name' %}selected{% endif %}>Product Name</option>
                                <option value="price" {% if sort_field == 'price' %}selected{% endif %}>Price</option>
                            </select>
                            <input type="hidden" name="order" id="id_sort-order" value="{{ sort_order }}">
                            <div class="sort-product-icon">
                                <i id="id_sort-order-btn" class="fa fa-sort-alpha-{{ sort_order }}"></i>
                            </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- ./ Center colunm -->
            </div>
            <!-- ./row-->
        </div>
    </div>
{% endblock content %}

{% block js %}
    <script type="text/javascript" src="{% static 'lib/jquery-ui/jquery-ui.min.js' %}"></script>
    <script>
        (function ($) {
            var $form = $('.cart-add-form');
            var $sortProductsForm = $('#product-sort-form');
            var $productsOrderDirection = $('#id_sort-order');
            $form.ajaxForm(function (res) {
                if(res.status === 'ok' && res.redirect) {
                    location.reload();
                }
                location.reload();
            });

            $('#id_sort-products').on('change', function () {
                $sortProductsForm.submit();
            });

            $('#id_sort-order-btn').on('click', function () {
                var order = $productsOrderDirection.val();
                var newVal = order === 'asc' ? 'desc' : 'asc';
                $productsOrderDirection.val(newVal);
                $sortProductsForm.submit();
            });
        })(jQuery);
    </script>
{% endblock js %}